#!/bin/bash

set -eu

export PATH=$PATH:$HOME/.gem/ruby/2.4.0/bin/:$HOME/.local/bin

# Level 1 - Really basic applications to run os
function level-1 {
    sudo pacman -S --needed --noconfirm \
        fish vim inotify-tools bc make git tmux openssh \
        rsync tree curl jq man at ripgrep ctags zip unzip \
        yaourt docker docker-compose arch-install-scripts \
        ruby

    # unset NVM_DIR
    # curl -o- https://raw.githubusercontent.com/creationix/nvm/master/install.sh | bash

    [ -e $HOME/.vim/plugged ] || curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

    sudo pacman -S --needed  \
        xorg xorg-xinit wmctrl synaptics xorg-xbacklight awesome \
        fcitx fcitx-im fcitx-mozc fcitx-configtool \
        terminator pcmanfm dmenu \
        xclip xdotool xscreensaver acpi alsa-lib alsa-utils \
        adobe-source-code-pro-fonts
    yaourt -S --needed \
        otf-ipaexfont maim google-chrome

    if ! which xremap; then
        cd /tmp
        git clone https://github.com/k0kubun/xremap
        cd xremap
        make
        sudo make install
    fi

    grep -q docker /etc/group || sudo groupadd docker
    sudo gpasswd -a $USER docker
    sudo gpasswd -a $USER sys
}

# Level 2 - Some developing packages
function level-2 {
    sudo pacman -S --needed --noconfirm \
        imagemagick \
        ghostscript \
        python3 python-pip gcc-fortran lapack libpng \
        go \
        lua \
        php composer \
        nodejs npm \
        jdk8-openjdk \
        clojure \
        wmctrl \
        xclip xdotool xscreensaver acpi alsa-lib alsa-utils \
        vlc feh pinta moc eog evince libreoffice-fresh wavpack inkscape

    yaourt -S --needed --noconfirm \
        leiningen \
        android-platform android-sdk android-sdk-platform-tools android-sdk-build-tools android-platform-23
    # https://stackoverflow.com/questions/39760172/you-have-not-accepted-the-license-agreements-of-the-following-sdk-components
    android update sdk --no-ui --all --filter platform-tools,android-25,extra-android-m2repository
    android update sdk --no-ui --all --filter build-tools-23.0.1,android-23,extra-android-m2repository
}

install-termianl-tool(){
    which bundle   || gem install bundler pry
    which mycli    || pip install --user --upgrade virtualenv ipython mycli csvkit
    which yarn     || npm install -g yarn exp create-react-app create-react-native-app vue-cli
    which psysh || composer global require psy/psysh
    which phpunit || composer global require phpunit/phpunit
    which pipenv || pip install --user pipenv

    sudo pacman -S --needed --noconfirm \
        graphviz transmission-cli rlwrap fzf tig expect \
        nmap traceroute openssl
    yaourt -S --needed --noconfirm nkf cmigemo-git
}

# level-1
level-2
install-termianl-tool
