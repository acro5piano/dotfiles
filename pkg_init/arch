#!/bin/bash

set -eu

export PATH=$PATH:$HOME/.gem/ruby/2.4.0/bin/:$HOME/.local/bin

sudo pacman -S --needed --noconfirm \
    fish \
    vim \
    inotify-tools \
    openssl \
    bc \
    make \
    git \
    tmux \
    openssh \
    rsync \
    tree \
    curl \
    jq \
    man \
    at \
    ripgrep \
    ctags \
    zip \
    unzip \
    fzf \
    docker \
    docker-compose \
    ruby \
    xorg \
    xorg-xinit \
    synaptics \
    awesome \
    fcitx \
    fcitx-im \
    fcitx-mozc \
    fcitx-configtool \
    terminator \
    pcmanfm \
    dmenu \
    xclip \
    xdotool \
    xscreensaver \
    acpi \
    alsa-lib \
    alsa-utils \
    adobe-source-code-pro-fonts \
    python3 python-pip gcc-fortran lapack libpng \
    go \
    lua \
    php php-gd php-sqlite composer \
    nodejs npm \
    jdk8-openjdk \
    clojure \
    arch-install-scripts \
    imagemagick ghostscript \
    httpie \
    wmctrl \
    vlc \
    feh \
    pinta \
    moc \
    eog \
    evince \
    libreoffice-fresh \
    wavpack \
    inkscape


git clone https://aur.archlinux.org/yay && makepkg -si --noconfirm && cd .. && rm -rf yay

yay -S --needed \
    otf-ipaexfont \
    maim \
    google-chrome \
    leiningen \
    android-platform android-sdk android-sdk-platform-tools android-sdk-build-tools android-platform-23 \
    ttf-emojione-color


[ -e $HOME/.vim/plugged ] || curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

[ -e $HOME/.local/share/nvim ] || curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

if [ ! -e ~/.config/fish/functions/fisher.fish ]; then
    curl -Lo ~/.config/fish/functions/fisher.fish --create-dirs https://git.io/fisher
    fisher
fi

if ! which xremap; then
    cd /tmp
    git clone https://github.com/k0kubun/xremap
    cd xremap
    make
    sudo make install
fi

grep -q docker /etc/group || sudo groupadd docker
sudo gpasswd -a $USER docker
sudo gpasswd -a $USER sys
echo $SHELL | grep -q fish || chsh -s /usr/bin/fish

# https://stackoverflow.com/questions/39760172/you-have-not-accepted-the-license-agreements-of-the-following-sdk-components
android update sdk --no-ui --all --filter platform-tools,android-25,extra-android-m2repository
android update sdk --no-ui --all --filter build-tools-23.0.1,android-23,extra-android-m2repository
sudo ln -s /opt/android-sdk/platform-tools/adb /usr/local/bin/adb

go get github.com/github/hub

# Clj
curl -L https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein | bash

# Node
nvm install 12.18.4
npm install -g \
    yarn \
    vue-cli \
    react-native-cli \
    create-react-app \
    firebase-tools \
    tldr \
    serve

# Python
pip3.6 install \
    virtualenv \
    poetry \
    awscli \
    pgcli \
    mycli \
    litecli \
    mypy \
    flake8 \
    pyls \
    docker-pretty-ps

# Rust
curl https://sh.rustup.rs -sSf | sh
rustup toolchain add nightly
cargo +nightly install racer

# Ruby
gem install solargraph
