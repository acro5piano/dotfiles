#!/bin/bash

DOTPATH="$HOME/.dotfiles"

pull(){
    git pull origin master
    link
}

link(){
    echo a
    for f in .??*
    do
        [ "$f" = ".git" ] && continue

        if [ -e "$HOME/$f" ]; then
            rm -rf "$HOME/$f"
        fi

        echo "$HOME/$f" '-->' "$DOTPATH/$f"
        ln -snfv "$DOTPATH/$f" "$HOME/$f"
    done

    ln -snfv "$DOTPATH/bin" "$HOME/bin"
}

usage(){
    echo 'dot: sync and manage dot files'
    echo ''
    echo 'commands:'
    echo '    pull - fetch + link'
    echo '    link - create symlink'
    exit 1
}

cd $DOTPATH

case $1 in
    'pull') pull ;;
    'link') link ;;
    *) usage ;;
esac

cd $OLD_PWD
