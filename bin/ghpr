#!/bin/bash

branch=$1
message=$2

url=""

set -ue

if [ -z "$message" ]; then
    message=`git log -1 --pretty=%B | head -1`
fi

if [ -z "$branch" ]; then
    url=`hub pull-request -m "$message"`
else
    if [ "$branch" == 'd' ]; then
        branch=develop
    fi
    if [ "$branch" == 'm' ]; then
        branch=master
    fi
    url=`hub pull-request -m "$message" -b "$branch"`
fi

if [ -z "$url" ]; then
    exit 2
fi

if [ `uname` == 'Linux' ]; then
    xdg-open $url
else
    open $url
fi
